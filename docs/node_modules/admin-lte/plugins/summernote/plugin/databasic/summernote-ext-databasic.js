!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}((function(e){var t=e.summernote.ui,a=e.summernote.dom;e.extend(!0,e.summernote,{plugins:{databasic:function(o){var n=this,i=o.options,r=i.langInfo;n.icon='<i class="fa fa-object-group"/>',o.memo("button.databasic",(function(){return t.button({contents:n.icon,tooltip:r.databasic.insert,click:o.createInvokeHandler("databasic.showDialog")}).render()})),o.memo("button.databasicDialog",(function(){return t.button({contents:n.icon,tooltip:r.databasic.edit,click:o.createInvokeHandler("databasic.showDialog")}).render()})),o.memo("button.databasicSize100",(function(){return t.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:r.image.resizeFull,click:o.createInvokeHandler("editor.resize","1")}).render()})),o.memo("button.databasicSize50",(function(){return t.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:r.image.resizeHalf,click:o.createInvokeHandler("editor.resize","0.5")}).render()})),o.memo("button.databasicSize25",(function(){return t.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:r.image.resizeQuarter,click:o.createInvokeHandler("editor.resize","0.25")}).render()})),n.events={"summernote.init":function(t,a){e("data.ext-databasic",a.editable).each((function(){n.setContent(e(this))}))},"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){n.update()},"summernote.dialog.shown":function(){n.hidePopover()}},n.initialize=function(){var a=i.dialogsInBody?e(document.body):o.layoutInfo.editor,s='<div class="form-group row-fluid"><label>'+r.databasic.testLabel+'</label><input class="ext-databasic-test form-control" type="text" /></div>',d='<button href="#" class="btn btn-primary ext-databasic-save">'+r.databasic.insert+"</button>";n.$dialog=t.dialog({title:r.databasic.name,fade:i.dialogsFade,body:s,footer:d}).render().appendTo(a),n.$popover=t.popover({className:"ext-databasic-popover"}).render().appendTo("body");var c=n.$popover.find(".popover-content");o.invoke("buttons.build",c,i.popover.databasic)},n.destroy=function(){n.$popover.remove(),n.$popover=null,n.$dialog.remove(),n.$dialog=null},n.update=function(){if(o.invoke("editor.hasFocus")){var t=o.invoke("editor.createRange"),i=!1;if(t.isOnData()){var r=e(t.sc).closest("data.ext-databasic");if(r.length){var s=a.posFromPlaceholder(r[0]);n.$popover.css({display:"block",left:s.left,top:s.top}),o.invoke("editor.saveTarget",r[0]),i=!0}}i||n.hidePopover()}else n.hidePopover()},n.hidePopover=function(){n.$popover.hide()},n.getInfo=function(){var t=o.invoke("editor.createRange");if(t.isOnData()){var a=e(t.sc).closest("data.ext-databasic");if(a.length)return{node:a,test:a.attr("data-test")}}return{}},n.setContent=function(e){e.html('<p contenteditable="false">'+n.icon+" "+r.databasic.name+": "+e.attr("data-test")+"</p>")},n.updateNode=function(e){n.setContent(e.node.attr("data-test",e.test))},n.createNode=function(t){var a=e('<data class="ext-databasic"></data>');return a&&(t.node=a,o.invoke("editor.insertNode",a[0])),a},n.showDialog=function(){var a=n.getInfo(),i=!a.node;o.invoke("editor.saveRange"),n.openDialog(a).then((function(r){t.hideDialog(n.$dialog),o.invoke("editor.restoreRange"),i&&n.createNode(a),e.extend(a,r),n.updateNode(a)})).fail((function(){o.invoke("editor.restoreRange")}))},n.openDialog=function(a){return e.Deferred((function(e){var i=n.$dialog.find(".ext-databasic-test"),s=n.$dialog.find(".ext-databasic-save"),d=function(e){13===e.keyCode&&s.trigger("click")};t.onDialogShown(n.$dialog,(function(){o.triggerEvent("dialog.shown"),i.val(a.test).on("input",(function(){t.toggleBtn(s,i.val())})).trigger("focus").on("keyup",d),s.text(a.node?r.databasic.edit:r.databasic.insert).click((function(t){t.preventDefault(),e.resolve({test:i.val()})})),t.toggleBtn(s,i.val())})),t.onDialogHidden(n.$dialog,(function(){i.off("input keyup"),s.off("click"),"pending"===e.state()&&e.reject()})),t.showDialog(n.$dialog)}))}}},options:{popover:{databasic:[["databasic",["databasicDialog","databasicSize100","databasicSize50","databasicSize25"]]]}},lang:{"en-US":{databasic:{name:"Basic Data Container",insert:"insert basic data container",edit:"edit basic data container",testLabel:"test input"}}}})}));